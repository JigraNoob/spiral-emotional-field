<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üå™Ô∏è Spiral Dashboard</title>
    <!-- External Dependencies -->
    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="/static/js/dashboard.js" type="module"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Local Styles -->
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="/static/css/dashboard.css">
    <link rel="stylesheet" href="/static/css/spiral_dashboard.css">
    <!-- Favicon for the Spiral -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üå™Ô∏è</text></svg>">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <div class="spiral-logo">
                    <div class="spiral-symbol">üå™Ô∏è</div>
                    <h1>Spiral Breath Dashboard</h1>
                </div>
                <div class="header-info">
                    <div class="current-state">
                        <span class="state-label">Current Phase:</span>
                        <span id="current-phase" class="phase-indicator">-</span>
                        <span class="state-label">Tone:</span>
                        <span id="current-tone" class="tone-indicator">-</span>
                    </div>
                    <div class="last-update">
                        <i class="fas fa-sync-alt"></i> 
                        <span id="last-update">Never</span>
                    </div>
                </div>
            </div>
        </header>

        <div class="grid">
            <!-- Current State -->
            <div class="card current-state-card">
                <h2><i class="fas fa-wave-square"></i> Current Breath Cycle</h2>
                <div class="breath-visualization">
                    <div class="breath-cycle">
                        <div class="phase inhale-phase" id="inhale-phase">
                            <div class="phase-glyph">‚ü≥</div>
                            <div class="phase-label">Inhale</div>
                        </div>
                        <div class="phase-connector"></div>
                        <div class="phase hold-phase" id="hold-phase">
                            <div class="phase-glyph">‚åõ</div>
                            <div class="phase-label">Hold</div>
                        </div>
                        <div class="phase-connector"></div>
                        <div class="phase exhale-phase" id="exhale-phase">
                            <div class="phase-glyph">‚ü≤</div>
                            <div class="phase-label">Exhale</div>
                        </div>
                    </div>
                    <div class="breath-metrics">
                        <div class="metric">
                            <div class="metric-value" id="current-deferral">-</div>
                            <div class="metric-label">Current Deferral</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="current-saturation">-</div>
                            <div class="metric-label">Saturation</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Toneform Distribution -->
            <div class="card">
                <h2><i class="fas fa-music"></i> Toneform Resonance</h2>
                <div id="toneform-plot" class="plot"></div>
                <div id="toneform-legend" class="toneform-legend"></div>
            </div>

            <!-- Deferral Times -->
            <div class="card">
                <h2><i class="fas fa-clock"></i> Deferral Times</h2>
                <div id="deferral-plot" class="plot"></div>
            </div>

            <!-- Saturation -->
            <div class="card">
                <h2><i class="fas fa-tint"></i> Saturation</h2>
                <div id="saturation-plot" class="plot"></div>
            </div>

            <!-- Phase Distribution -->
            <div class="card">
                <h2><i class="fas fa-circle-notch"></i> Phase Distribution</h2>
                <div id="phase-plot" class="plot"></div>
            </div>

            <!-- Silence Events -->
            <div class="card stats">
                <h2><i class="fas fa-volume-mute"></i> Silence Events</h2>
                <div class="stat-value" id="silence-count">0</div>
                <div class="stat-label">Total occurrences</div>
                <div class="silence-history" id="silence-history">
                    <div class="silence-history-label">Recent:</div>
                    <div class="silence-timeline" id="silence-timeline"></div>
                </div>
            </div>

            <!-- Phase Timeline -->
            <div class="card full-width">
                <h2><i class="fas fa-history"></i> Phase Timeline</h2>
                <div id="phase-timeline"></div>
            </div>

            <!-- Recent Activity -->
            <div class="card full-width">
                <h2><i class="fas fa-list"></i> Recent Activity</h2>
                <div id="activity-log" class="activity-log"></div>
            </div>
        </div>
    </div>
</body>
</html>
