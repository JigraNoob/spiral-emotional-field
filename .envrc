# .envrc for Spiral project - Multi-platform optimized
VENV="./swe-1"

# Detect environment and set appropriate paths
if [[ "$OSTYPE" == "msys" || "$OSTYPE" == "cygwin" ]]; then
  echo "ü™ü Git Bash detected"
  VENV_PATH="./swe-1/Scripts"
  ACTIVATE_SCRIPT="$VENV_PATH/activate"
elif grep -q Microsoft /proc/version 2>/dev/null; then
  echo "üêß WSL detected"
  VENV_PATH="./swe-1/bin"
  ACTIVATE_SCRIPT="$VENV_PATH/activate"
else
  echo "üêß Linux/Unix detected"
  VENV_PATH="./swe-1/bin"
  ACTIVATE_SCRIPT="$VENV_PATH/activate"
fi

# Check if virtual environment exists
if [ -d "$VENV" ]; then
  # Check for appropriate activation script
  if [ -f "$ACTIVATE_SCRIPT" ]; then
    source "$ACTIVATE_SCRIPT"
    echo "‚úÖ Virtual environment activated: $VENV"
    echo "   Python: $(which python)"
    echo "   Pip: $(which pip)"
  else
    echo "‚ùå Virtual environment found but activation script missing"
    echo "   Expected: $ACTIVATE_SCRIPT"
    echo "   To fix this, recreate the venv:"
    echo "   rm -rf swe-1 && python -m venv swe-1 && direnv allow"
  fi
else
  echo "‚ö†Ô∏è Virtual environment not found at $VENV"
  echo "   To create it, run: python -m venv swe-1"
  echo "   Then: direnv allow"
fi
